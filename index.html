<!DOCTYPE html>
<html lang="ru">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>WG Archer Run</title>
Â  <script src="https://telegram.org/js/telegram-web-app.js"></script>
Â  <style>
Â  Â  body{
Â  Â  Â  margin:0; font-family: Arial, sans-serif; background:#111; color:#fff;
Â  Â  Â  display:flex; flex-direction:column; align-items:center;
Â  Â  }
Â  Â  h2{ margin:14px 0 8px; }
Â  Â  #wrap{ width:min(900px, 96vw); }
Â  Â  #hud{
Â  Â  Â  display:flex; justify-content:space-between; align-items:center;
Â  Â  Â  gap:10px; margin:8px 0;
Â  Â  Â  font-size:16px;
Â  Â  }
Â  Â  #game{
Â  Â  Â  position:relative; width:100%; height:min(520px, 70vh);
Â  Â  Â  background: linear-gradient(#2a2a2a, #1a1a1a);
Â  Â  Â  overflow:hidden; border-radius:12px;
Â  Â  Â  box-shadow: 0 8px 30px rgba(0,0,0,.35);
Â  Â  Â  user-select:none;
Â  Â  Â  touch-action: manipulation;
Â  Â  }
Â  Â  #ground{
Â  Â  Â  position:absolute; left:0; right:0; bottom:0; height:70px;
Â  Â  Â  background: linear-gradient(#2f2f2f, #242424);
Â  Â  Â  border-top: 2px solid rgba(255,255,255,.08);
Â  Â  }
Â  Â  #player{
Â  Â  Â  position:absolute; left:70px; width:42px; height:42px;
Â  Â  Â  bottom:70px; /* ÑÑ‚Ğ¾Ğ¸Ñ‚ Ğ½Ğ° Ğ·ĞµĞ¼Ğ»Ğµ */
Â  Â  Â  background: #ffb000;
Â  Â  Â  border-radius:10px;
Â  Â  Â  box-shadow: 0 6px 0 rgba(0,0,0,.25);
Â  Â  }
Â  Â  /* Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ğ¹ "Ğ»ÑƒĞº" */
Â  Â  #player::after{
Â  Â  Â  content:""; position:absolute; right:-6px; top:10px;
Â  Â  Â  width:10px; height:22px; border:3px solid #ffd27a;
Â  Â  Â  border-left:none; border-radius:0 14px 14px 0;
Â  Â  Â  opacity:.9;
Â  Â  }
Â  Â  .obstacle{
Â  Â  Â  position:absolute; bottom:70px; width:28px; height:52px;
Â  Â  Â  background:#d3264a; border-radius:8px;
Â  Â  Â  box-shadow: 0 6px 0 rgba(0,0,0,.25);
Â  Â  }
Â  Â  .pit{
Â  Â  Â  position:absolute; bottom:0; height:70px; width:70px;
Â  Â  Â  background:#0b0b0b;
Â  Â  Â  border-top: 2px dashed rgba(255,255,255,.15);
Â  Â  }
Â  Â  #panel{
Â  Â  Â  display:flex; gap:10px; align-items:center; margin:10px 0 0;
Â  Â  Â  flex-wrap:wrap;
Â  Â  }
Â  Â  button{
Â  Â  Â  background:#3b82f6; border:none; color:#fff;
Â  Â  Â  padding:10px 16px; border-radius:10px; font-size:16px;
Â  Â  Â  cursor:pointer;
Â  Â  }
Â  Â  button:active{ transform:scale(.98); }
Â  Â  button.secondary{ background:#444; }
Â  Â  #msg{
Â  Â  Â  margin:10px 0 0; padding:10px 12px; border-radius:10px;
Â  Â  Â  background: rgba(255,255,255,.06);
Â  Â  Â  display:none;
Â  Â  Â  white-space:pre-line;
Â  Â  }
Â  Â  #hint{
Â  Â  Â  opacity:.85; font-size:13px; margin-top:6px;
Â  Â  }
Â  </style>
</head>

<body>
Â  <div id="wrap">
Â  Â  <h2>ğŸ¹ WG Archer Run</h2>

Â  Â  <div id="hud">
Â  Â  Â  <div>â± Ğ’Ñ€ĞµĞ¼Ñ: <span id="t">0.0</span> ÑĞµĞº</div>
Â  Â  Â  <div>ğŸ Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ: <span id="d">0</span> Ğ¼</div>
Â  Â  Â  <div>âš¡ Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ: <span id="s">1.0</span>x</div>
Â  Â  </div>

Â  Â  <div id="game">
Â  Â  Â  <div id="player"></div>
Â  Â  Â  <div id="ground"></div>
Â  Â  </div>

Â  Â  <div id="panel">
Â  Â  Â  <button id="btnStart">Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ</button>
Â  Â  Â  <button id="btnRestart" class="secondary" style="display:none;">Ğ—Ğ°Ğ½Ğ¾Ğ²Ğ¾</button>
Â  Â  </div>

Â  Â  <div id="msg"></div>
Â  Â  <div id="hint">Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ: Ğ¿Ñ€Ğ¾Ğ±ĞµĞ» / ĞºĞ»Ğ¸Ğº Ğ¼Ñ‹ÑˆÑŒÑ / Ñ‚Ğ°Ğ¿ Ğ¿Ğ¾ ÑĞºÑ€Ğ°Ğ½Ñƒ = Ğ¿Ñ€Ñ‹Ğ¶Ğ¾Ğº.</div>
Â  </div>

<script>
(() => {
Â  const game = document.getElementById("game");
Â  const player = document.getElementById("player");
Â  const tEl = document.getElementById("t");
Â  const dEl = document.getElementById("d");
Â  const sEl = document.getElementById("s");
Â  const btnStart = document.getElementById("btnStart");
Â  const btnRestart = document.getElementById("btnRestart");
Â  const msg = document.getElementById("msg");

Â  // Telegram WebApp
Â  const tg = window.Telegram?.WebApp;
Â  if (tg) {
Â  Â  tg.ready();
Â  Â  tg.expand();
Â  }

Â  // Ñ„Ğ¸Ğ·Ğ¸ĞºĞ°
Â  let alive = false;
Â  let jumping = false;
Â  let vy = 0;
Â  const gravity = 0.9;
Â  const jumpPower = 16;

Â  // Ğ²Ñ€ĞµĞ¼Ñ/ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ
Â  let time = 0; Â  Â  Â  Â  Â // ÑĞµĞºÑƒĞ½Ğ´Ñ‹
Â  let distance = 0; Â  Â  Â // Ğ¼ĞµÑ‚Ñ€Ñ‹
Â  let speedMul = 1.0; Â  Â // Ğ¼Ğ½Ğ¾Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ¸
Â  let lastTs = null;

Â  // Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ñ
Â  let obstacles = [];
Â  let pits = [];
Â  let spawnTimer = 0;

Â  function reset() {
Â  Â  alive = false;
Â  Â  jumping = false;
Â  Â  vy = 0;
Â  Â  time = 0;
Â  Â  distance = 0;
Â  Â  speedMul = 1.0;
Â  Â  lastTs = null;
Â  Â  spawnTimer = 0;

Â  Â  // Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ğ¹
Â  Â  obstacles.forEach(o => o.remove());
Â  Â  pits.forEach(p => p.remove());
Â  Â  obstacles = [];
Â  Â  pits = [];

Â  Â  // Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ°
Â  Â  player.style.bottom = "70px";

Â  Â  tEl.textContent = "0.0";
Â  Â  dEl.textContent = "0";
Â  Â  sEl.textContent = "1.0";
Â  Â  msg.style.display = "none";
Â  Â  btnRestart.style.display = "none";
Â  Â  btnStart.style.display = "inline-block";
Â  }

Â  function showMessage(text) {
Â  Â  msg.textContent = text;
Â  Â  msg.style.display = "block";
Â  }

Â  function jump() {
Â  Â  if (!alive) return;
Â  Â  if (jumping) return;
Â  Â  jumping = true;
Â  Â  vy = jumpPower;
Â  }

Â  function rect(el) {
Â  Â  return el.getBoundingClientRect();
Â  }

Â  function intersects(a, b) {
Â  Â  return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
Â  }

Â  function spawnSomething() {
Â  Â  // Ñ€Ğ°Ğ½Ğ´Ğ¾Ğ¼: Ğ»Ğ¸Ğ±Ğ¾ Ğ±Ğ°Ñ€ÑŒĞµÑ€, Ğ»Ğ¸Ğ±Ğ¾ ÑĞ¼Ğ°
Â  Â  const r = Math.random();
Â  Â  if (r < 0.72) {
Â  Â  Â  // Ğ±Ğ°Ñ€ÑŒĞµÑ€
Â  Â  Â  const o = document.createElement("div");
Â  Â  Â  o.className = "obstacle";
Â  Â  Â  o.style.left = game.clientWidth + "px";
Â  Â  Â  // Ğ¸Ğ½Ğ¾Ğ³Ğ´Ğ° Ğ´ĞµĞ»Ğ°ĞµĞ¼ Ñ‡ÑƒÑ‚ÑŒ Ğ²Ñ‹ÑˆĞµ/Ğ½Ğ¸Ğ¶Ğµ
Â  Â  Â  const h = 42 + Math.floor(Math.random() * 26); // 42..67
Â  Â  Â  o.style.height = h + "px";
Â  Â  Â  game.appendChild(o);
Â  Â  Â  obstacles.push(o);
Â  Â  } else {
Â  Â  Â  // ÑĞ¼Ğ° (Ğ´Ñ‹Ñ€Ğ° Ğ² Ğ·ĞµĞ¼Ğ»Ğµ)
Â  Â  Â  const p = document.createElement("div");
Â  Â  Â  p.className = "pit";
Â  Â  Â  p.style.left = game.clientWidth + "px";
Â  Â  Â  const w = 60 + Math.floor(Math.random() * 60); // 60..119
Â  Â  Â  p.style.width = w + "px";
Â  Â  Â  game.appendChild(p);
Â  Â  Â  pits.push(p);
Â  Â  }
Â  }

Â  function endGame(reason) {
Â  Â  alive = false;
Â  Â  btnRestart.style.display = "inline-block";
Â  Â  btnStart.style.display = "none";

Â  Â  const text =
Â  Â  Â  `ğŸ’€ Ğ—Ğ°Ğ±ĞµĞ³ Ğ¾ĞºĞ¾Ğ½Ñ‡ĞµĞ½!\n` +
Â  Â  Â  `â± Ğ’Ñ€ĞµĞ¼Ñ: ${time.toFixed(1)} ÑĞµĞº\n` +
Â  Â  Â  `ğŸ Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ: ${Math.floor(distance)} Ğ¼\n` +
Â  Â  Â  `ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°: ${reason}`;

Â  Â  showMessage(text);

Â  Â  // ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ° Ğ² Telegram (ĞµÑĞ»Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¾ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ Ğ±Ğ¾Ñ‚Ğ°)
Â  Â  if (tg) {
Â  Â  Â  try {
Â  Â  Â  Â  tg.sendData(JSON.stringify({
Â  Â  Â  Â  Â  game: "archer_run",
Â  Â  Â  Â  Â  time: Number(time.toFixed(2)),
Â  Â  Â  Â  Â  distance: Math.floor(distance)
Â  Â  Â  Â  }));
Â  Â  Â  } catch(e) {}
Â  Â  }
Â  }

Â  function loop(ts) {
Â  Â  if (!alive) return;

Â  Â  if (lastTs === null) lastTs = ts;
Â  Â  const dt = Math.min(0.033, (ts - lastTs) / 1000); // ÑĞµĞº, Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡Ğ¸Ğ¼ Ğ»Ğ°Ğ³Ğ¸
Â  Â  lastTs = ts;

Â  Â  // Ğ²Ñ€ĞµĞ¼Ñ Ğ¸ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ
Â  Â  time += dt;
Â  Â  // ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚ ÑĞ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½ĞµĞ¼ (Ğ¿Ğ»Ğ°Ğ²Ğ½Ğ¾)
Â  Â  speedMul = 1.0 + Math.min(2.5, time / 40); // Ğº 100 ÑĞµĞº ~ 3.5x
Â  Â  const baseSpeed = 220; // px/sec
Â  Â  const move = baseSpeed * speedMul * dt;

Â  Â  distance += (move / 10); // Ğ³Ñ€ÑƒĞ±Ğ¾: 10px = 1Ğ¼ (Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿Ğ¾Ğ¼ĞµĞ½ÑÑ‚ÑŒ)

Â  Â  // Ñ„Ğ¸Ğ·Ğ¸ĞºĞ° Ğ¿Ñ€Ñ‹Ğ¶ĞºĞ°
Â  Â  vy -= gravity;
Â  Â  let bottom = parseFloat(player.style.bottom);
Â  Â  bottom += vy;

Â  Â  if (bottom <= 70) {
Â  Â  Â  bottom = 70;
Â  Â  Â  vy = 0;
Â  Â  Â  jumping = false;
Â  Â  }
Â  Â  player.style.bottom = bottom + "px";

Â  Â  // ÑĞ¿Ğ°Ğ²Ğ½ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ğ¹
Â  Â  spawnTimer += dt;
Â  Â  // Ñ‡ĞµĞ¼ Ğ²Ñ‹ÑˆĞµ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ â€” Ñ‚ĞµĞ¼ Ñ‡Ğ°Ñ‰Ğµ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ñ
Â  Â  const spawnEvery = Math.max(0.7, 1.4 - (speedMul - 1) * 0.18); // 1.4 -> 0.7
Â  Â  if (spawnTimer >= spawnEvery) {
Â  Â  Â  spawnTimer = 0;
Â  Â  Â  spawnSomething();
Â  Â  }

Â  Â  // Ğ´Ğ²Ğ¸Ğ³Ğ°ĞµĞ¼ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ñ
Â  Â  obstacles.forEach((o, idx) => {
Â  Â  Â  const left = parseFloat(o.style.left) - move;
Â  Â  Â  o.style.left = left + "px";
Â  Â  Â  if (left < -80) {
Â  Â  Â  Â  o.remove();
Â  Â  Â  Â  obstacles.splice(idx, 1);
Â  Â  Â  }
Â  Â  });

Â  Â  pits.forEach((p, idx) => {
Â  Â  Â  const left = parseFloat(p.style.left) - move;
Â  Â  Â  p.style.left = left + "px";
Â  Â  Â  if (left < -200) {
Â  Â  Â  Â  p.remove();
Â  Â  Â  Â  pits.splice(idx, 1);
Â  Â  Â  }
Â  Â  });

Â  Â  // ĞºĞ¾Ğ»Ğ»Ğ¸Ğ·Ğ¸Ğ¸ Ñ Ğ±Ğ°Ñ€ÑŒĞµÑ€Ğ°Ğ¼Ğ¸
Â  Â  const pr = rect(player);
Â  Â  for (const o of obstacles) {
Â  Â  Â  const or = rect(o);
Â  Â  Â  if (intersects(pr, or)) {
Â  Â  Â  Â  endGame("Ğ²Ñ€ĞµĞ·Ğ°Ğ»ÑÑ Ğ² Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ğµ");
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  }

Â  Â  // Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ Ğ² ÑĞ¼Ñƒ: ĞµÑĞ»Ğ¸ Ğ¸Ğ³Ñ€Ğ¾Ğº Ğ½Ğ° Ğ·ĞµĞ¼Ğ»Ğµ (bottom == 70) Ğ¸ Ğ¿Ğ¾Ğ´ Ğ½Ğ¸Ğ¼ ĞµÑÑ‚ÑŒ ÑĞ¼Ğ°
Â  Â  if (!jumping) {
Â  Â  Â  for (const p of pits) {
Â  Â  Â  Â  const prRect = rect(player);
Â  Â  Â  Â  const pitRect = rect(p);

Â  Â  Â  Â  // ĞµÑĞ»Ğ¸ Ñ†ĞµĞ½Ñ‚Ñ€ Ğ¸Ğ³Ñ€Ğ¾ĞºĞ° Ğ¿Ğ¾ X Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ½Ğ°Ğ´ ÑĞ¼Ğ¾Ğ¹ â€” Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ
Â  Â  Â  Â  const centerX = (prRect.left + prRect.right) / 2;
Â  Â  Â  Â  if (centerX > pitRect.left && centerX < pitRect.right) {
Â  Â  Â  Â  Â  endGame("ÑƒĞ¿Ğ°Ğ» Ğ² ÑĞ¼Ñƒ");
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }

Â  Â  // HUD
Â  Â  tEl.textContent = time.toFixed(1);
Â  Â  dEl.textContent = String(Math.floor(distance));
Â  Â  sEl.textContent = speedMul.toFixed(1);

Â  Â  requestAnimationFrame(loop);
Â  }

Â  function start() {
Â  Â  reset();
Â  Â  alive = true;
Â  Â  btnStart.style.display = "none";
Â  Â  btnRestart.style.display = "none";
Â  Â  // Ğ½ĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğ¹ ÑĞ¿Ğ°Ğ²Ğ½, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğµ Ğ±Ñ‹Ğ»Ğ¾ Ğ¿ÑƒÑÑ‚Ğ¾
Â  Â  spawnTimer = 0.8;
Â  Â  requestAnimationFrame(loop);
Â  }

Â  // ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
Â  document.addEventListener("keydown", (e) => {
Â  Â  if (e.code === "Space") {
Â  Â  Â  e.preventDefault();
Â  Â  Â  jump();
Â  Â  }
Â  });
Â  game.addEventListener("click", jump);
Â  game.addEventListener("touchstart", (e) => {
Â  Â  e.preventDefault();
Â  Â  jump();
Â  }, { passive:false });

Â  btnStart.addEventListener("click", start);
Â  btnRestart.addEventListener("click", start);

Â  reset();
})();
</script>
</body>
</html>
