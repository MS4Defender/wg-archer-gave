<!doctype html>
<html lang="ru">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
Â  <title>WG Archer Run</title>
Â  <script src="https://telegram.org/js/telegram-web-app.js"></script>
Â  <style>
Â  Â  :root{
Â  Â  Â  --bg:#0b1224;
Â  Â  Â  --panel:rgba(15,23,42,.65);
Â  Â  Â  --accent:#22c55e;
Â  Â  Â  --danger:#ef4444;
Â  Â  Â  --text:#e5e7eb;
Â  Â  Â  --muted:rgba(229,231,235,.75);
Â  Â  }
Â  Â  html,body{
Â  Â  Â  margin:0; padding:0;
Â  Â  Â  height:100%;
Â  Â  Â  background:var(--bg);
Â  Â  Â  overflow:hidden; /* Ğ²Ğ°Ğ¶Ğ½Ğ¾: Ğ½Ğ¸ĞºĞ°ĞºĞ¾Ğ³Ğ¾ ÑĞºÑ€Ğ¾Ğ»Ğ»Ğ° */
Â  Â  Â  font-family:Arial, sans-serif;
Â  Â  Â  color:var(--text);
Â  Â  Â  -webkit-user-select:none;
Â  Â  Â  user-select:none;
Â  Â  Â  touch-action:manipulation;
Â  Â  }

Â  Â  /* Ğ¸Ğ³Ñ€Ğ° Ğ½Ğ° Ğ²ĞµÑÑŒ ÑĞºÑ€Ğ°Ğ½ mini-app */
Â  Â  #root{
Â  Â  Â  position:fixed;
Â  Â  Â  inset:0;
Â  Â  Â  background:linear-gradient(#0b1224,#0a1020);
Â  Â  }
Â  Â  canvas{
Â  Â  Â  width:100%;
Â  Â  Â  height:100%;
Â  Â  Â  display:block;
Â  Â  }

Â  Â  /* UI Ğ¿Ğ¾Ğ²ĞµÑ€Ñ… */
Â  Â  .hud{
Â  Â  Â  position:absolute;
Â  Â  Â  left:12px;
Â  Â  Â  right:12px;
Â  Â  Â  top:12px;
Â  Â  Â  display:flex;
Â  Â  Â  justify-content:space-between;
Â  Â  Â  gap:12px;
Â  Â  Â  pointer-events:none; /* Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ñ‚Ğ°Ğ¿ ÑˆÑ‘Ğ» Ğ² Ğ¸Ğ³Ñ€Ñƒ */
Â  Â  }
Â  Â  .brand{
Â  Â  Â  display:flex; align-items:center; gap:8px;
Â  Â  Â  font-weight:900;
Â  Â  Â  letter-spacing:.5px;
Â  Â  Â  text-shadow:0 2px 12px rgba(0,0,0,.6);
Â  Â  }
Â  Â  .stats{
Â  Â  Â  display:flex;
Â  Â  Â  gap:10px;
Â  Â  Â  flex-wrap:wrap;
Â  Â  Â  justify-content:flex-end;
Â  Â  }
Â  Â  .chip{
Â  Â  Â  background:var(--panel);
Â  Â  Â  border:1px solid rgba(255,255,255,.08);
Â  Â  Â  padding:8px 10px;
Â  Â  Â  border-radius:12px;
Â  Â  Â  font-size:13px;
Â  Â  Â  color:var(--muted);
Â  Â  Â  backdrop-filter: blur(6px);
Â  Â  }
Â  Â  .chip b{ color:var(--text); }

Â  Â  .bottom{
Â  Â  Â  position:absolute;
Â  Â  Â  left:12px;
Â  Â  Â  right:12px;
Â  Â  Â  bottom:12px;
Â  Â  Â  display:flex;
Â  Â  Â  justify-content:center;
Â  Â  Â  gap:12px;
Â  Â  Â  pointer-events:auto; /* ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ ĞºĞ»Ğ¸ĞºĞ°Ğ±ĞµĞ»ÑŒĞ½Ñ‹ */
Â  Â  Â  padding-bottom: env(safe-area-inset-bottom);
Â  Â  }
Â  Â  button{
Â  Â  Â  border:none;
Â  Â  Â  border-radius:14px;
Â  Â  Â  padding:12px 18px;
Â  Â  Â  font-weight:800;
Â  Â  Â  background:rgba(255,255,255,.88);
Â  Â  Â  color:#0b1224;
Â  Â  }
Â  Â  button.secondary{ background:rgba(255,255,255,.25); color:var(--text); border:1px solid rgba(255,255,255,.15); }

Â  Â  /* Game Over Ğ¿Ğ¾ Ñ†ĞµĞ½Ñ‚Ñ€Ñƒ */
Â  Â  .overlay{
Â  Â  Â  position:absolute;
Â  Â  Â  inset:0;
Â  Â  Â  display:none;
Â  Â  Â  align-items:center;
Â  Â  Â  justify-content:center;
Â  Â  Â  text-align:center;
Â  Â  Â  background:rgba(0,0,0,.35);
Â  Â  Â  backdrop-filter: blur(2px);
Â  Â  Â  pointer-events:none;
Â  Â  Â  padding:24px;
Â  Â  }
Â  Â  .overlay.show{ display:flex; }
Â  Â  .card{
Â  Â  Â  background:rgba(15,23,42,.75);
Â  Â  Â  border:1px solid rgba(255,255,255,.12);
Â  Â  Â  border-radius:18px;
Â  Â  Â  padding:18px 18px;
Â  Â  Â  max-width:420px;
Â  Â  Â  width:100%;
Â  Â  Â  box-shadow:0 20px 80px rgba(0,0,0,.55);
Â  Â  }
Â  Â  .card h2{
Â  Â  Â  margin:0 0 8px 0;
Â  Â  Â  font-size:26px;
Â  Â  Â  color:#fff;
Â  Â  }
Â  Â  .card p{
Â  Â  Â  margin:0;
Â  Â  Â  color:var(--muted);
Â  Â  Â  font-size:14px;
Â  Â  Â  line-height:1.35;
Â  Â  }
Â  Â  .card .score{
Â  Â  Â  margin-top:10px;
Â  Â  Â  font-size:16px;
Â  Â  Â  color:#fff;
Â  Â  Â  font-weight:800;
Â  Â  }
Â  Â  .hint{
Â  Â  Â  position:absolute;
Â  Â  Â  left:12px; right:12px;
Â  Â  Â  bottom:72px;
Â  Â  Â  text-align:center;
Â  Â  Â  font-size:13px;
Â  Â  Â  color:rgba(229,231,235,.65);
Â  Â  Â  pointer-events:none;
Â  Â  Â  padding-bottom: env(safe-area-inset-bottom);
Â  Â  }
Â  </style>
</head>
<body>
Â  <div id="root">
Â  Â  <canvas id="c"></canvas>

Â  Â  <div class="hud">
Â  Â  Â  <div class="brand">ğŸ¹ WG Archer Run</div>
Â  Â  Â  <div class="stats">
Â  Â  Â  Â  <div class="chip">ğŸ <b id="dist">0</b> Ğ¼</div>
Â  Â  Â  Â  <div class="chip">âš¡ <b id="spd">1.0</b>x</div>
Â  Â  Â  Â  <div class="chip">ğŸ† <b id="best">0</b> Ğ¼</div>
Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="hint">Ğ¢Ğ°Ğ¿ Ğ¿Ğ¾ ÑĞºÑ€Ğ°Ğ½Ñƒ â€” Ğ¿Ñ€Ñ‹Ğ¶Ğ¾Ğº</div>

Â  Â  <div class="bottom">
Â  Â  Â  <button id="btnPlay">â–¶ Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ</button>
Â  Â  Â  <button id="btnReset" class="secondary">âŸ² Ğ¡Ğ±Ñ€Ğ¾Ñ</button>
Â  Â  </div>

Â  Â  <div id="over" class="overlay">
Â  Â  Â  <div class="card">
Â  Â  Â  Â  <h2>GAME OVER</h2>
Â  Â  Â  Â  <p>ĞÑˆĞ¸Ğ±ÑÑ â€” ÑĞ¼ĞµÑ€Ñ‚ÑŒ. ĞĞ°Ğ¶Ğ¼Ğ¸ Â«Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒÂ» Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾.</p>
Â  Â  Â  Â  <div class="score">Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ: <span id="finalDist">0</span> Ğ¼</div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </div>

<script>
Â  const tg = window.Telegram?.WebApp;
Â  if (tg) tg.expand();

Â  const canvas = document.getElementById('c');
Â  const ctx = canvas.getContext('2d');

Â  const elDist = document.getElementById('dist');
Â  const elSpd Â = document.getElementById('spd');
Â  const elBest = document.getElementById('best');
Â  const overEl = document.getElementById('over');
Â  const finalDistEl = document.getElementById('finalDist');

Â  const btnPlay = document.getElementById('btnPlay');
Â  const btnReset = document.getElementById('btnReset');

Â  let W=0, H=0, dpr=1;

Â  function resize(){
Â  Â  dpr = Math.max(1, Math.min(2.5, window.devicePixelRatio || 1));
Â  Â  W = Math.floor(window.innerWidth);
Â  Â  H = Math.floor(window.innerHeight);
Â  Â  canvas.width Â = Math.floor(W * dpr);
Â  Â  canvas.height = Math.floor(H * dpr);
Â  Â  canvas.style.width = W+'px';
Â  Â  canvas.style.height = H+'px';
Â  Â  ctx.setTransform(dpr,0,0,dpr,0,0);
Â  }
Â  window.addEventListener('resize', resize);
Â  resize();

Â  // --- Ğ¡Ğ¿Ñ€Ğ°Ğ¹Ñ‚ (archer.png) ---
Â  const archer = new Image();
Â  archer.src = 'archer.png';

Â  // Ğ¢Ğ’ĞĞ¯ ĞšĞĞ Ğ¢Ğ˜ĞĞšĞ = 6 ĞºĞ°Ğ´Ñ€Ğ¾Ğ² (3x2). Ğ‘ĞµÑ€Ñ‘Ğ¼ Ğ¾Ğ´Ğ¸Ğ½ ĞºĞ°Ğ´Ñ€, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğµ Ñ€Ğ¸ÑĞ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²ÑÑ Ğ¿Ñ€Ğ¾ÑÑ‚Ñ‹Ğ½Ñ.
Â  function getFrameRect(frameIndex){
Â  Â  // 3 ĞºĞ¾Ğ»Ğ¾Ğ½ĞºĞ¸, 2 ÑÑ‚Ñ€Ğ¾ĞºĞ¸
Â  Â  const cols = 3, rows = 2;
Â  Â  const fw = archer.width / cols;
Â  Â  const fh = archer.height / rows;
Â  Â  const i = Math.max(0, Math.min(cols*rows-1, frameIndex));
Â  Â  const sx = (i % cols) * fw;
Â  Â  const sy = Math.floor(i / cols) * fh;
Â  Â  return {sx, sy, fw, fh};
Â  }

Â  // --- ĞœĞ¸Ñ€ ---
Â  const GROUND_H = 64;
Â  const GROUND_PAD = 16; // Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğµ Ğ¿Ñ€ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ Ğ·Ğ° Ğ½Ğ¸Ğ¶Ğ½ĞµĞ¹ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒÑ Ñ‚ĞµĞ»ĞµĞ³Ğ¸
Â  function groundY(){ return H - GROUND_H - GROUND_PAD - 40; } // 40 â€” Ğ·Ğ°Ğ¿Ğ°Ñ Ğ¿Ğ¾Ğ´ ĞºĞ½Ğ¾Ğ¿ĞºĞ¸/Ğ±Ğ°Ñ€ Ğ¼Ğ¸Ğ½Ğ¸Ğ°Ğ¿Ğ¿Ğ°

Â  const player = {
Â  Â  x: 70,
Â  Â  y: 0,
Â  Â  w: 72,
Â  Â  h: 72,
Â  Â  vy: 0,
Â  Â  jumping: false
Â  };

Â  let obstacles = [];
Â  let running = false;
Â  let gameOver = false;

Â  let speed = 6; Â  Â  Â // Ğ±ÑƒĞ´ĞµÑ‚ Ğ¿Ğ»Ğ°Ğ²Ğ½Ğ¾ Ñ€Ğ°ÑÑ‚Ğ¸
Â  let distance = 0;
Â  let best = Number(localStorage.getItem('wg_best') || 0);

Â  elBest.textContent = best;

Â  function resetState(){
Â  Â  obstacles = [];
Â  Â  speed = 6;
Â  Â  distance = 0;
Â  Â  player.vy = 0;
Â  Â  player.jumping = false;
Â  Â  player.y = groundY() - player.h;
Â  Â  gameOver = false;
Â  Â  overEl.classList.remove('show');
Â  Â  elDist.textContent = 0;
Â  Â  elSpd.textContent = '1.0';
Â  }

Â  function start(){
Â  Â  resetState();
Â  Â  running = true;
Â  Â  loop();
Â  }

Â  function die(){
Â  Â  running = false;
Â  Â  gameOver = true;
Â  Â  if(distance > best){
Â  Â  Â  best = distance;
Â  Â  Â  localStorage.setItem('wg_best', String(best));
Â  Â  Â  elBest.textContent = best;
Â  Â  }
Â  Â  finalDistEl.textContent = distance;
Â  Â  overEl.classList.add('show');
Â  }

Â  function jump(){
Â  Â  if(!running || gameOver) return;
Â  Â  if(!player.jumping){
Â  Â  Â  player.vy = -15;
Â  Â  Â  player.jumping = true;
Â  Â  }
Â  }

Â  // ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ: Ğ¢ĞĞ›Ğ¬ĞšĞ Ğ¢ĞĞŸ
Â  canvas.addEventListener('touchstart', (e)=>{ e.preventDefault(); jump(); }, {passive:false});

Â  btnPlay.addEventListener('click', ()=> start());
Â  btnReset.addEventListener('click', ()=> resetState());

Â  // --- ĞŸÑ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ñ (Ñ„Ğ¸ĞºÑĞ¸Ñ€ÑƒĞµĞ¼ â€œĞ½ĞµĞ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¿ĞµÑ€ĞµĞ¿Ñ€Ñ‹Ğ³Ğ½ÑƒÑ‚ÑŒâ€) ---
Â  // ĞœÑ‹ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ€ÑƒĞµĞ¼ Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸ÑĞ¼Ğ¸ Ğ¸ Ğ½Ğµ ÑÑ‚Ğ°Ğ²Ğ¸Ğ¼ 5 Ğ¿Ğ¾Ğ´Ñ€ÑĞ´.
Â  let nextSpawnAt = 160; // Ğ² Ğ¼ĞµÑ‚Ñ€Ğ°Ñ…
Â  function scheduleNextSpawn(){
Â  Â  // Ñ€Ğ°ÑÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸ÑĞ¼Ğ¸ 120..220Ğ¼, Ğ° Ğ½Ğµ Ğ¿Ğ°Ñ‡ĞºĞ°Ğ¼Ğ¸
Â  Â  nextSpawnAt = distance + randInt(120, 220);
Â  }
Â  function spawnObstacle(){
Â  Â  const h = randInt(36, 68);
Â  Â  obstacles.push({
Â  Â  Â  x: W + 20,
Â  Â  Â  w: randInt(26, 40),
Â  Â  Â  h
Â  Â  });
Â  }

Â  function randInt(a,b){ return Math.floor(a + Math.random()*(b-a+1)); }

Â  // --- ĞšĞ¾Ğ»Ğ»Ğ¸Ğ·Ğ¸Ğ¸ ---
Â  function hit(player, obs){
Â  Â  const px1 = player.x+10, px2 = player.x + player.w-10;
Â  Â  const py1 = player.y+8, Â py2 = player.y + player.h-6;

Â  Â  const ox1 = obs.x, ox2 = obs.x + obs.w;
Â  Â  const oy1 = groundY() - obs.h, oy2 = groundY();

Â  Â  return (px1 < ox2 && px2 > ox1 && py1 < oy2 && py2 > oy1);
Â  }

Â  // --- Ğ ĞµĞ½Ğ´ĞµÑ€ ---
Â  function draw(){
Â  Â  // Ñ„Ğ¾Ğ½
Â  Â  ctx.fillStyle = '#0b1224';
Â  Â  ctx.fillRect(0,0,W,H);

Â  Â  // Ğ·ĞµĞ¼Ğ»Ñ
Â  Â  ctx.fillStyle = '#1e293b';
Â  Â  ctx.fillRect(0, groundY(), W, GROUND_H);

Â  Â  // Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ñ
Â  Â  ctx.fillStyle = '#ef4444';
Â  Â  for(const o of obstacles){
Â  Â  Â  ctx.fillRect(o.x, groundY()-o.h, o.w, o.h);
Â  Â  }

Â  Â  // Ğ¸Ğ³Ñ€Ğ¾Ğº (Ğ¾Ğ´Ğ¸Ğ½ ĞºĞ°Ğ´Ñ€)
Â  Â  if(archer.complete && archer.naturalWidth){
Â  Â  Â  // 0 â€” ĞºĞ°Ğ´Ñ€ Ğ±ĞµĞ³Ğ° (Ğ²ĞµÑ€Ñ…Ğ½Ğ¸Ğ¹ Ğ»ĞµĞ²Ñ‹Ğ¹), 1 â€” Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€Ñ‹Ğ¶ĞºĞ° Ğ¿Ğ¾Ğ·Ğ¶Ğµ
Â  Â  Â  const frame = player.jumping ? 1 : 0;
Â  Â  Â  const {sx,sy,fw,fh} = getFrameRect(frame);
Â  Â  Â  ctx.drawImage(archer, sx,sy,fw,fh, player.x, player.y, player.w, player.h);
Â  Â  } else {
Â  Â  Â  // Ğ½Ğ° Ğ²ÑÑĞºĞ¸Ğ¹ ÑĞ»ÑƒÑ‡Ğ°Ğ¹ Ğ·Ğ°Ğ³Ğ»ÑƒÑˆĞºĞ°
Â  Â  Â  ctx.fillStyle = '#fff';
Â  Â  Â  ctx.fillRect(player.x, player.y, player.w, player.h);
Â  Â  }
Â  }

Â  // --- Ğ˜Ğ³Ñ€Ğ¾Ğ²Ğ¾Ğ¹ Ñ†Ğ¸ĞºĞ» ---
Â  let lastTs = 0;
Â  function loop(ts=0){
Â  Â  if(!running) return;

Â  Â  const dt = Math.min(32, ts-lastTs || 16);
Â  Â  lastTs = ts;

Â  Â  // ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚ Ğ¿Ğ»Ğ°Ğ²Ğ½Ğ¾
Â  Â  speed += 0.0008 * dt; // Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ¼ÑĞ³ĞºĞ¾
Â  Â  const speedMul = 1 + (speed-6)/20;

Â  Â  // Ğ¼ĞµÑ‚Ñ€Ñ‹ (Ñ‡ĞµÑÑ‚Ğ½ĞµĞµ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸)
Â  Â  distance += Math.max(1, Math.floor(speedMul)); // Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚ Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚Ğ¸
Â  Â  elDist.textContent = distance;
Â  Â  elSpd.textContent = speedMul.toFixed(1);

Â  Â  // ÑĞ¿Ğ°Ğ²Ğ½ Ğ¿Ğ¾ Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼
Â  Â  if(distance >= nextSpawnAt){
Â  Â  Â  spawnObstacle();
Â  Â  Â  scheduleNextSpawn();
Â  Â  }

Â  Â  // Ñ„Ğ¸Ğ·Ğ¸ĞºĞ° Ğ¿Ñ€Ñ‹Ğ¶ĞºĞ°
Â  Â  player.vy += 0.85;
Â  Â  player.y += player.vy;

Â  Â  const gy = groundY() - player.h;
Â  Â  if(player.y >= gy){
Â  Â  Â  player.y = gy;
Â  Â  Â  player.vy = 0;
Â  Â  Â  player.jumping = false;
Â  Â  }

Â  Â  // Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ğ¹
Â  Â  for(const o of obstacles) o.x -= speed;

Â  Â  // Ñ‡Ğ¸ÑÑ‚ĞºĞ°
Â  Â  obstacles = obstacles.filter(o => o.x + o.w > -20);

Â  Â  // ĞºĞ¾Ğ»Ğ»Ğ¸Ğ·Ğ¸Ğ¸
Â  Â  for(const o of obstacles){
Â  Â  Â  if(hit(player, o)){
Â  Â  Â  Â  draw();
Â  Â  Â  Â  die();
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  }

Â  Â  draw();
Â  Â  requestAnimationFrame(loop);
Â  }

Â  // ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
Â  resetState();
Â  scheduleNextSpawn();
Â  draw();
</script>
</body>
</html>
