<!DOCTYPE html>
<html lang="ru">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
Â  <title>WG Archer Run</title>

Â  <!-- Telegram WebApp -->
Â  <script src="https://telegram.org/js/telegram-web-app.js"></script>

Â  <style>
Â  Â  :root { color-scheme: dark; }

Â  Â  body{
Â  Â  Â  margin:0;
Â  Â  Â  font-family: Arial, sans-serif;
Â  Â  Â  background:#111;
Â  Â  Â  color:#fff;
Â  Â  Â  display:flex;
Â  Â  Â  flex-direction:column;
Â  Â  Â  align-items:center;
Â  Â  }
Â  Â  h2{ margin:14px 0 8px; }

Â  Â  #wrap{ width:min(900px, 96vw); }

Â  Â  #hud{
Â  Â  Â  display:flex;
Â  Â  Â  justify-content:space-between;
Â  Â  Â  align-items:center;
Â  Â  Â  gap:10px;
Â  Â  Â  margin:8px 0;
Â  Â  Â  font-size:16px;
Â  Â  Â  flex-wrap:wrap;
Â  Â  }

Â  Â  /* Ğ’ĞĞ–ĞĞ: Ñ„Ğ¸ĞºÑĞ¸Ñ€ÑƒĞµĞ¼ Ğ²Ñ‹ÑĞ¾Ñ‚Ñƒ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ° iPhone Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ±Ñ‹Ğ»Ğ¾ Ğ²Ğ¸Ğ´Ğ½Ğ¾ */
Â  Â  #game{
Â  Â  Â  position:relative;
Â  Â  Â  width:100%;
Â  Â  Â  height:420px;
Â  Â  Â  background:#2a2a2a;
Â  Â  Â  overflow:hidden;
Â  Â  Â  border-radius:12px;
Â  Â  Â  border:2px solid rgba(255,255,255,.15);
Â  Â  Â  user-select:none;
Â  Â  Â  touch-action: manipulation;
Â  Â  }

Â  Â  #ground{
Â  Â  Â  position:absolute;
Â  Â  Â  left:0; right:0; bottom:0;
Â  Â  Â  height:70px;
Â  Â  Â  background:#242424;
Â  Â  Â  border-top:2px solid rgba(255,255,255,.12);
Â  Â  Â  z-index:1;
Â  Â  }

Â  Â  #player{
Â  Â  Â  position:absolute;
Â  Â  Â  left:70px;
Â  Â  Â  width:42px;
Â  Â  Â  height:42px;
Â  Â  Â  bottom:70px;
Â  Â  Â  background:#ffb000;
Â  Â  Â  border-radius:10px;
Â  Â  Â  z-index:2;
Â  Â  Â  box-shadow: 0 6px 0 rgba(0,0,0,.25);
Â  Â  }
Â  Â  /* Ğ½ĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¹ "Ğ»ÑƒĞº" */
Â  Â  #player::after{
Â  Â  Â  content:"";
Â  Â  Â  position:absolute;
Â  Â  Â  right:-6px; top:10px;
Â  Â  Â  width:10px; height:22px;
Â  Â  Â  border:3px solid #ffd27a;
Â  Â  Â  border-left:none;
Â  Â  Â  border-radius:0 14px 14px 0;
Â  Â  Â  opacity:.9;
Â  Â  }

Â  Â  .obstacle{
Â  Â  Â  position:absolute;
Â  Â  Â  bottom:70px;
Â  Â  Â  width:28px;
Â  Â  Â  height:52px;
Â  Â  Â  background:#d3264a;
Â  Â  Â  border-radius:8px;
Â  Â  Â  z-index:2;
Â  Â  Â  box-shadow: 0 6px 0 rgba(0,0,0,.25);
Â  Â  }

Â  Â  .pit{
Â  Â  Â  position:absolute;
Â  Â  Â  bottom:0;
Â  Â  Â  height:70px;
Â  Â  Â  width:90px;
Â  Â  Â  background:#0b0b0b;
Â  Â  Â  border-top: 2px dashed rgba(255,255,255,.15);
Â  Â  Â  z-index:0;
Â  Â  }

Â  Â  /* ĞĞ²ĞµÑ€Ğ»ĞµĞ¹ â€œĞ˜Ğ³Ñ€Ğ°Ñ‚ÑŒâ€ Ğ¿Ñ€ÑĞ¼Ğ¾ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ Ğ¿Ğ¾Ğ»Ñ */
Â  Â  #overlay{
Â  Â  Â  position:absolute;
Â  Â  Â  inset:0;
Â  Â  Â  display:flex;
Â  Â  Â  align-items:center;
Â  Â  Â  justify-content:center;
Â  Â  Â  flex-direction:column;
Â  Â  Â  gap:10px;
Â  Â  Â  background: rgba(0,0,0,.35);
Â  Â  Â  z-index:10;
Â  Â  }
Â  Â  #overlay button{
Â  Â  Â  background:#3b82f6;
Â  Â  Â  border:none;
Â  Â  Â  color:#fff;
Â  Â  Â  padding:14px 18px;
Â  Â  Â  border-radius:12px;
Â  Â  Â  font-size:18px;
Â  Â  Â  cursor:pointer;
Â  Â  }
Â  Â  #overlay small{
Â  Â  Â  opacity:.85;
Â  Â  Â  text-align:center;
Â  Â  Â  max-width:80%;
Â  Â  Â  line-height:1.3;
Â  Â  }

Â  Â  #msg{
Â  Â  Â  margin:10px 0 0;
Â  Â  Â  padding:10px 12px;
Â  Â  Â  border-radius:10px;
Â  Â  Â  background: rgba(255,255,255,.06);
Â  Â  Â  display:none;
Â  Â  Â  white-space:pre-line;
Â  Â  }
Â  Â  #hint{
Â  Â  Â  opacity:.85;
Â  Â  Â  font-size:13px;
Â  Â  Â  margin-top:8px;
Â  Â  Â  margin-bottom:10px;
Â  Â  }
Â  </style>
</head>

<body>
Â  <div id="wrap">
Â  Â  <h2>ğŸ¹ WG Archer Run</h2>

Â  Â  <div id="hud">
Â  Â  Â  <div>â± Ğ’Ñ€ĞµĞ¼Ñ: <span id="t">0.0</span> ÑĞµĞº</div>
Â  Â  Â  <div>ğŸ Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ: <span id="d">0</span> Ğ¼</div>
Â  Â  Â  <div>âš¡ Ğ¡ĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ: <span id="s">1.0</span>x</div>
Â  Â  </div>

Â  Â  <div id="game">
Â  Â  Â  <div id="overlay">
Â  Â  Â  Â  <button id="btnStart">â–¶ Ğ˜Ğ³Ñ€Ğ°Ñ‚ÑŒ</button>
Â  Â  Â  Â  <small>Ğ¢Ğ°Ğ¿/ĞºĞ»Ğ¸Ğº/Ğ¿Ñ€Ğ¾Ğ±ĞµĞ» â€” Ğ¿Ñ€Ñ‹Ğ¶Ğ¾Ğº.<br>ĞÑˆĞ¸Ğ±ÑÑ â€” ÑĞ¼ĞµÑ€Ñ‚ÑŒ, Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑˆÑŒ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾.</small>
Â  Â  Â  </div>

Â  Â  Â  <div id="player"></div>
Â  Â  Â  <div id="ground"></div>
Â  Â  </div>

Â  Â  <div id="msg"></div>
Â  Â  <div id="hint">Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ: Ğ¿Ñ€Ğ¾Ğ±ĞµĞ» / ĞºĞ»Ğ¸Ğº Ğ¼Ñ‹ÑˆÑŒÑ / Ñ‚Ğ°Ğ¿ Ğ¿Ğ¾ ÑĞºÑ€Ğ°Ğ½Ñƒ = Ğ¿Ñ€Ñ‹Ğ¶Ğ¾Ğº.</div>
Â  </div>

<script>
(() => {
Â  const game = document.getElementById("game");
Â  const player = document.getElementById("player");
Â  const overlay = document.getElementById("overlay");
Â  const btnStart = document.getElementById("btnStart");
Â  const tEl = document.getElementById("t");
Â  const dEl = document.getElementById("d");
Â  const sEl = document.getElementById("s");
Â  const msg = document.getElementById("msg");

Â  const tg = window.Telegram?.WebApp;
Â  if (tg) { try { tg.ready(); tg.expand(); } catch(e){} }

Â  // Ñ„Ğ¸Ğ·Ğ¸ĞºĞ°
Â  let alive = false;
Â  let jumping = false;
Â  let vy = 0;
Â  const gravity = 0.9;
Â  const jumpPower = 16;

Â  // Ğ²Ñ€ĞµĞ¼Ñ/ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ
Â  let time = 0; Â  Â  Â  Â  Â // ÑĞµĞº
Â  let distance = 0; Â  Â  Â // Ğ¼
Â  let speedMul = 1.0;
Â  let lastTs = null;

Â  // Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ñ
Â  let obstacles = [];
Â  let pits = [];
Â  let spawnTimer = 0;

Â  function showMessage(text){
Â  Â  msg.textContent = text;
Â  Â  msg.style.display = "block";
Â  }
Â  function hideMessage(){
Â  Â  msg.style.display = "none";
Â  }

Â  function reset(){
Â  Â  alive = false;
Â  Â  jumping = false;
Â  Â  vy = 0;
Â  Â  time = 0;
Â  Â  distance = 0;
Â  Â  speedMul = 1.0;
Â  Â  lastTs = null;
Â  Â  spawnTimer = 0;

Â  Â  obstacles.forEach(o => o.remove());
Â  Â  pits.forEach(p => p.remove());
Â  Â  obstacles = [];
Â  Â  pits = [];

Â  Â  player.style.bottom = "70px";

Â  Â  tEl.textContent = "0.0";
Â  Â  dEl.textContent = "0";
Â  Â  sEl.textContent = "1.0";

Â  Â  overlay.style.display = "flex";
Â  Â  hideMessage();
Â  }

Â  function jump(){
Â  Â  if (!alive) return;
Â  Â  if (jumping) return;
Â  Â  jumping = true;
Â  Â  vy = jumpPower;
Â  }

Â  function rect(el){ return el.getBoundingClientRect(); }
Â  function intersects(a,b){
Â  Â  return !(a.right < b.left || a.left > b.right || a.bottom < b.top || a.top > b.bottom);
Â  }

Â  function spawnSomething(){
Â  Â  const r = Math.random();
Â  Â  if (r < 0.72){
Â  Â  Â  const o = document.createElement("div");
Â  Â  Â  o.className = "obstacle";
Â  Â  Â  o.style.left = game.clientWidth + "px";
Â  Â  Â  const h = 42 + Math.floor(Math.random() * 26); // 42..67
Â  Â  Â  o.style.height = h + "px";
Â  Â  Â  game.appendChild(o);
Â  Â  Â  obstacles.push(o);
Â  Â  } else {
Â  Â  Â  const p = document.createElement("div");
Â  Â  Â  p.className = "pit";
Â  Â  Â  p.style.left = game.clientWidth + "px";
Â  Â  Â  const w = 70 + Math.floor(Math.random() * 80); // 70..149
Â  Â  Â  p.style.width = w + "px";
Â  Â  Â  game.appendChild(p);
Â  Â  Â  pits.push(p);
Â  Â  }
Â  }

Â  function endGame(reason){
Â  Â  alive = false;
Â  Â  overlay.style.display = "flex";
Â  Â  btnStart.textContent = "ğŸ” Ğ—Ğ°Ğ½Ğ¾Ğ²Ğ¾";

Â  Â  const text =
Â  Â  Â  `ğŸ’€ Ğ—Ğ°Ğ±ĞµĞ³ Ğ¾ĞºĞ¾Ğ½Ñ‡ĞµĞ½!\n` +
Â  Â  Â  `â± Ğ’Ñ€ĞµĞ¼Ñ: ${time.toFixed(1)} ÑĞµĞº\n` +
Â  Â  Â  `ğŸ Ğ”Ğ¸ÑÑ‚Ğ°Ğ½Ñ†Ğ¸Ñ: ${Math.floor(distance)} Ğ¼\n` +
Â  Â  Â  `ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°: ${reason}`;
Â  Â  showMessage(text);

Â  Â  // Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚ Ğ±Ğ¾Ñ‚Ñƒ (Ğ¿Ğ¾Ğ·Ğ¶Ğµ ÑÑ‚Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ Ğ´Ğ»Ñ Ğ½Ğ°Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ñ Ğ¼Ğ¾Ğ½ĞµÑ‚)
Â  Â  if (tg){
Â  Â  Â  try{
Â  Â  Â  Â  tg.sendData(JSON.stringify({
Â  Â  Â  Â  Â  game: "archer_run",
Â  Â  Â  Â  Â  time: Number(time.toFixed(2)),
Â  Â  Â  Â  Â  distance: Math.floor(distance)
Â  Â  Â  Â  }));
Â  Â  Â  } catch(e){}
Â  Â  }
Â  }

Â  function loop(ts){
Â  Â  if (!alive) return;

Â  Â  if (lastTs === null) lastTs = ts;
Â  Â  const dt = Math.min(0.033, (ts - lastTs) / 1000);
Â  Â  lastTs = ts;

Â  Â  // Ğ²Ñ€ĞµĞ¼Ñ Ğ¸ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ
Â  Â  time += dt;
Â  Â  speedMul = 1.0 + Math.min(2.5, time / 40); // Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚
Â  Â  const baseSpeed = 220; // px/sec
Â  Â  const move = baseSpeed * speedMul * dt;
Â  Â  distance += (move / 10); // 10px = 1Ğ¼

Â  Â  // Ğ¿Ñ€Ñ‹Ğ¶Ğ¾Ğº
Â  Â  vy -= gravity;
Â  Â  let bottom = parseFloat(player.style.bottom);
Â  Â  bottom += vy;

Â  Â  if (bottom <= 70){
Â  Â  Â  bottom = 70;
Â  Â  Â  vy = 0;
Â  Â  Â  jumping = false;
Â  Â  }
Â  Â  player.style.bottom = bottom + "px";

Â  Â  // ÑĞ¿Ğ°Ğ²Ğ½
Â  Â  spawnTimer += dt;
Â  Â  const spawnEvery = Math.max(0.7, 1.4 - (speedMul - 1) * 0.18);
Â  Â  if (spawnTimer >= spawnEvery){
Â  Â  Â  spawnTimer = 0;
Â  Â  Â  spawnSomething();
Â  Â  }

Â  Â  // Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ğ¹
Â  Â  for (let i = obstacles.length - 1; i >= 0; i--){
Â  Â  Â  const o = obstacles[i];
Â  Â  Â  const left = parseFloat(o.style.left) - move;
Â  Â  Â  o.style.left = left + "px";
Â  Â  Â  if (left < -120){ o.remove(); obstacles.splice(i,1); }
Â  Â  }
Â  Â  for (let i = pits.length - 1; i >= 0; i--){
Â  Â  Â  const p = pits[i];
Â  Â  Â  const left = parseFloat(p.style.left) - move;
Â  Â  Â  p.style.left = left + "px";
Â  Â  Â  if (left < -220){ p.remove(); pits.splice(i,1); }
Â  Â  }

Â  Â  // ĞºĞ¾Ğ»Ğ»Ğ¸Ğ·Ğ¸Ğ¸
Â  Â  const pr = rect(player);
Â  Â  for (const o of obstacles){
Â  Â  Â  if (intersects(pr, rect(o))){
Â  Â  Â  Â  endGame("Ğ²Ñ€ĞµĞ·Ğ°Ğ»ÑÑ Ğ² Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ğµ");
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  }

Â  Â  // Ğ¿Ğ°Ğ´ĞµĞ½Ğ¸Ğµ Ğ² ÑĞ¼Ñƒ (ĞµÑĞ»Ğ¸ Ğ½Ğ° Ğ·ĞµĞ¼Ğ»Ğµ)
Â  Â  if (!jumping){
Â  Â  Â  const prRect = rect(player);
Â  Â  Â  const centerX = (prRect.left + prRect.right) / 2;
Â  Â  Â  for (const p of pits){
Â  Â  Â  Â  const pitRect = rect(p);
Â  Â  Â  Â  if (centerX > pitRect.left && centerX < pitRect.right){
Â  Â  Â  Â  Â  endGame("ÑƒĞ¿Ğ°Ğ» Ğ² ÑĞ¼Ñƒ");
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }

Â  Â  // HUD
Â  Â  tEl.textContent = time.toFixed(1);
Â  Â  dEl.textContent = String(Math.floor(distance));
Â  Â  sEl.textContent = speedMul.toFixed(1);

Â  Â  requestAnimationFrame(loop);
Â  }

Â  function start(){
Â  Â  // Ğ²Ğ°Ğ¶Ğ½Ğ¾: ÑĞºÑ€Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¾Ğ²ĞµÑ€Ğ»ĞµĞ¹ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµĞ¼
Â  Â  overlay.style.display = "none";
Â  Â  hideMessage();

Â  Â  alive = true;
Â  Â  jumping = false;
Â  Â  vy = 0;
Â  Â  time = 0;
Â  Â  distance = 0;
Â  Â  speedMul = 1.0;
Â  Â  lastTs = null;

Â  Â  // Ğ¾Ñ‡Ğ¸ÑÑ‚Ğ¸Ğ¼ Ğ¿Ñ€ĞµĞ¿ÑÑ‚ÑÑ‚Ğ²Ğ¸Ñ Ğ¿ĞµÑ€ĞµĞ´ ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ¼
Â  Â  obstacles.forEach(o => o.remove());
Â  Â  pits.forEach(p => p.remove());
Â  Â  obstacles = [];
Â  Â  pits = [];
Â  Â  spawnTimer = 0.8;

Â  Â  player.style.bottom = "70px";

Â  Â  requestAnimationFrame(loop);
Â  }

Â  // ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
Â  document.addEventListener("keydown", (e) => {
Â  Â  if (e.code === "Space"){
Â  Â  Â  e.preventDefault();
Â  Â  Â  jump();
Â  Â  }
Â  });

Â  // Ğ¢Ğ°Ğ¿ Ğ¿Ğ¾ Ğ¿Ğ¾Ğ»Ñ â€” Ğ¿Ñ€Ñ‹Ğ¶Ğ¾Ğº (Ğ¸ Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ iOS Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ²Ğ¾ÑĞ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»)
Â  game.addEventListener("pointerdown", (e) => {
Â  Â  // ĞµÑĞ»Ğ¸ ĞµÑ‰Ñ‘ Ğ½Ğµ ÑÑ‚Ğ°Ñ€Ñ‚Ğ¾Ğ²Ğ°Ğ»Ğ¸ â€” ÑÑ‚Ğ°Ñ€Ñ‚ÑƒĞµĞ¼
Â  Â  if (!alive && overlay.style.display !== "none"){
Â  Â  Â  start();
Â  Â  Â  return;
Â  Â  }
Â  Â  jump();
Â  });

Â  // ĞºĞ½Ğ¾Ğ¿ĞºĞ° â€œĞ˜Ğ³Ñ€Ğ°Ñ‚ÑŒâ€
Â  btnStart.addEventListener("click", start);

Â  // init
Â  reset();
})();
</script>
</body>
</html>
